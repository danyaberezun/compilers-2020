-- Expression evaluator

import List;
import State;

public fun oper(op, l, r){
	case op of
		  "+" -> l + r
		| "-" -> l - r
		| "*" -> l * r
		| "/" -> l / r
		| "%" -> l % r
		| ">" -> l > r
		| "<" -> l < r
		| "==" -> l == r
		| "!=" -> l != r
		| "<=" -> l <= r
		| ">=" -> l >= r
		| "&&" -> l && r
		| "!!" -> l !! r
	esac
}

public fun evalExpr(st, expr){
	case expr of
          Var(x) -> st(x)
        | Const(n) -> n
        | Binop(op, e1, e2) -> oper(op, evalExpr(st, e1), evalExpr(st, e2))
    esac
}
